!function(){var a;return window.Detector=a={canvas:!!window.CanvasRenderingContext2D,workers:!!window.Worker,fileapi:window.File&&window.FileReader&&window.FileList&&window.Blob,webgl:function(){var a;try{return!!window.WebGLRenderingContext&&!!document.createElement("canvas").getContext("experimental-webgl")}catch(b){return a=b,!1}}(),WebGLErrorMessage:{get:function(){},add:function(){}},errorClass:"webgl-error-message",errorId:"detector",style:{color:"#000",background:"#fff",fontFamily:"normal 13px/15px monospace",textAlign:"center",width:"400px",padding:"1.5em",margin:"5em auto 0"},unsupported:{browser:"Your browser does not seem to support <a href='http://khronos.org/webgl/wiki/Getting_a_WebGL_Implementation' style='color:#000'>WebGL</a>.<br/>					  Find out how to get it <a href='http://get.webgl.org/' style='color:#000'>here</a>.",graphics:"Your graphics card does not seem to support <a href='http://khronos.org/webgl/wiki/Getting_a_WebGL_Implementation' style='color:#000'>WebGL</a>.<br />					   Find out how to get it <a href='http://get.webgl.org/' style='color:#000'>here</a>."}},a.webgl?void 0:a.WebGLErrorMessage={get:function(b){var c,d,e,f,g;null==b&&(b=a.errorClass),c=document.createElement("div"),c.classList.add(b),g=a.style;for(e in g)f=g[e],c.style[e]=f;return d=window.WebGLRenderingContext?"graphics":"browser",c.innerHTML=a.unsupported[d],c},add:function(b,c){var d;return null==b&&(b=document.body),null==c&&(c=a.errorId),d=a.WebGLErrorMessage.get(c),b.appendChild(d),d}}}();var Stats;Stats=function(){var a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s;for(k=Date.now(),l=k,f=0,m=1/0,n=0,g=0,o=1/0,p=0,q=0,r=0,e=document.createElement("div"),e.id="stats",e.addEventListener("mousedown",function(a){return a.preventDefault(),s(++r%2)},!1),e.style.cssText="width:80px;opacity:0.9;cursor:pointer",a=document.createElement("div"),a.id="fps",a.style.cssText="padding:0 0 3px 3px;text-align:left;background-color:#002",e.appendChild(a),h=document.createElement("div"),h.id="fpsText",h.style.cssText="color:#0ff;font-family:Helvetica,Arial,sans-serif;font-size:9px;font-weight:bold;line-height:15px",h.innerHTML="FPS",a.appendChild(h),b=document.createElement("div"),b.id="fpsGraph",b.style.cssText="position:relative;width:74px;height:30px;background-color:#0ff",a.appendChild(b);74>b.children.length;)i=document.createElement("span"),i.style.cssText="width:1px;height:30px;float:left;background-color:#113",b.appendChild(i);for(c=document.createElement("div"),c.id="ms",c.style.cssText="padding:0 0 3px 3px;text-align:left;background-color:#020;display:none",e.appendChild(c),j=document.createElement("div"),j.id="msText",j.style.cssText="color:#0f0;font-family:Helvetica,Arial,sans-serif;font-size:9px;font-weight:bold;line-height:15px",j.innerHTML="MS",c.appendChild(j),d=document.createElement("div"),d.id="msGraph",d.style.cssText="position:relative;width:74px;height:30px;background-color:#0f0",c.appendChild(d);74>d.children.length;)i=document.createElement("span"),i.style.cssText="width:1px;height:30px;float:left;background-color:#131",d.appendChild(i);return s=function(b){switch(r=b){case 0:return a.style.display="block",c.style.display="none";case 1:return a.style.display="none",c.style.display="block"}},{REVISION:11,domElement:e,setMode:s,begin:function(){return k=Date.now()},end:function(){var c;return c=Date.now(),f=c-k,m=Math.min(m,f),n=Math.max(n,f),j.textContent=f+" MS ("+m+"-"+n+")",a=Math.min(30,30-30*(f/200)),d.appendChild(d.firstChild).style.height=a+"px",q++,c>l+1e3&&(g=Math.round(1e3*q/(c-l)),o=Math.min(o,g),p=Math.max(p,g),h.textContent=g+" FPS ("+o+"-"+p+")",a=Math.min(30,30-30*(g/100)),b.appendChild(b.firstChild).style.height=a+"px",l=c,q=0),c},update:function(){return k=this.end()}}};var S3age;S3age=function(){function a(b,c){var d=this;null==b&&(b="body"),this.defaults=null!=c?c:{},("undefined"!=typeof Detector&&null!==Detector?Detector.webgl:void 0)||Detector.WebGLErrorMessage.add(),this["default"](this.defaults),this.camera=this.renderer=this.scene=this.controls=this.stats=void 0,this.FPS=100,this.frame=0,this.scene=new THREE.Scene,this.clock=new a.Clock,this.camera=a.Camera(this,this.defaults.camera),this.renderer=a.Renderer(this,this.defaults.renderer),this.effects(this.defaults.effects),null!=this.defaults.scene&&this.dress(this.defaults.scene),this.controls=this.defaults.controls,"function"==typeof this.controls&&(this.controls=new this.controls(this.scene,this)),this._container=document.querySelector(b),this._container.appendChild(this.renderer.domElement),window.addEventListener("resize",function(){return d.onResize()}),this.onResize(),this.clicks(),this.defaults.debug&&(this.debug=a.Debug(this,c.statistics,c.inspector),this.testPlan=c.testPlan),this.update(),this.defaults.autostart&&this.start()}return a.prototype["default"]=function(a){var b,c;return null==a.autostart&&(a.autostart=!0),null==a.renderer&&(a.renderer={}),null==a.camera&&(a.camera={}),null==a.effects&&(a.effects=[]),null==a.scene&&(a.scene={}),null==(b=a.scene).lights&&(b.lights=[]),null==(c=a.scene).children&&(c.children=[]),null==a.inspector&&(a.inspector=a.expose||!1),null==a.statistics&&(a.statistics=a.stats||!0),null==a.debug&&(a.debug=a.testing||window.TESTING||!1),this},a.prototype.dress=function(a){var b,c,d,e,f,g,h,i,j;for(a.fog&&(this.scene.fog=a.fog),h=a.lights,d=0,f=h.length;f>d;d++)c=h[d],this.scene.add(c);for(i=a.children,j=[],e=0,g=i.length;g>e;e++)b=i[e],j.push(this.scene.add(b));return j},a.prototype.start=function(){var a=this;return setTimeout(function(){return a.clock.start()},0),this.running=!0,this},a.prototype.stop=function(){return this.running=!1,this},a.prototype.size=function(){return this.width=this._container.clientWidth,this.height=this._container.clientHeight,this.aspect=this.width/this.height},a.prototype.onResize=function(){var a,b,c,d,e,f,g,h;for(this.size(),this.camera.resize(),this.renderer.resize(),g=this.scene.children,c=0,e=g.length;e>c;c++)a=g[c],"function"==typeof a.resize&&a.resize(this.width,this.height);for(h=this.defaults.effects,d=0,f=h.length;f>d;d++)b=h[d],"function"==typeof b.resize&&b.resize(this.width,this.height);return this},a.prototype.clicks=function(){return this.clicked=function(a){var b,c,d,e,f;for(f=[],d=0,e=a.length;e>d;d++)b=a[d],f.push("function"==typeof(c=b.object).onclick?c.onclick(b):void 0);return f},a.Click(this._container,this),this},a.prototype.effects=function(a){var b,c,d,e,f,g;if(!THREE.EffectComposer)return a.length&&console.warn("Processing pipeline requested, but no EffectComposer available."),void 0;for(a.unshift(new THREE.RenderPass(this.scene,this.camera)),a.push(new THREE.ShaderPass(THREE.CopyShader)),c=0,e=a.length;e>c;c++)b=a[c],b.renderToScreen=!1;for(a[a.length-1].renderToScreen=!0,this.composer=new THREE.EffectComposer(this.renderer),g=[],d=0,f=a.length;f>d;d++)b=a[d],g.push(this.composer.addPass(b));return g},a.prototype.render=function(){return(THREE.EffectComposer?this.composer:this.renderer).render(),"function"==typeof this.debug?this.debug():void 0},a.prototype.update=function(){var a,b,c,d,e,f,g,h=this;if(this.running){this.frame++,null!=(d=this.stats)&&d.begin(),null!=(e=this.controls)&&e.update(this.clock);try{for(f=this.scene.children,b=0,c=f.length;c>b;b++)a=f[b],"function"==typeof a.update&&a.update(this.clock)}catch(i){}this.render(),null!=(g=this.stats)&&g.end()}return setTimeout(function(){return requestAnimationFrame(function(){return h.update()})},1e3/this.FPS),this},a.prototype.raycast=function(){var a;return a=new THREE.Projector,function(b,c){var d,e;return e=new THREE.Vector3(2*(b/this._container.clientWidth)-1,2*-(c/this._container.clientHeight)+1,.5),a.unprojectVector(e,this.camera),e.sub(this.camera.position).normalize(),d=new THREE.Raycaster(this.camera.position,e)}}(),a}(),S3age.Debug=function(a,b,c){var d;return null==b&&(b=!1),null==c&&(c=!1),function(){var d,e;return e=function(){return a.stats=new Stats,a.stats.domElement.style.position="absolute",a.stats.domElement.style.top="0px",a._container.appendChild(a.stats.domElement)},d=function(){return window.camera=a.camera,window.scene=a.scene,window.renderer=a.renderer},b&&e(),c?d():void 0}(),d=void 0,function(){var b,c;return b=document.createElement("canvas"),c=b.getContext("2d"),d=function(){return b.width=a.width,b.height=a.height,c.drawImage(a.renderer.domElement,0,0)},d.image=function(){return b}}(),d},S3age.Clock=function(){function a(a,b){var c,d,e,f,g=this;null==a&&(a=Date.now),null==b&&(b=!1),e=c=this.elapsed=this.delta=0,d=!!b,f=function(){return d?(c=g.elapsed,g.now=a(),g.elapsed=g.now-e,g.delta=g.elapsed-c):void 0},this.start=function(){return d=!0,e=a(),f(),this},d&&this.start()}return a}(),S3age.Camera=function(a,b){var c,d,e,f;return null==b&&(b={}),e=b.fov||45,f=b.near||1,d=b.far||1e3,c=new THREE.PerspectiveCamera(e,a.aspect,f,d),b.position instanceof THREE.Vector3&&(c.position=b.position),b.position instanceof Array&&c.position.fromArray(b.position),b.lookAt&&c.lookAt((new THREE.Vector3).fromArray(b.lookAt)),c.resize=function(){return c.aspect=a.aspect,c.updateProjectionMatrix()},["fov","near","far"].forEach(function(a){var b,d,e;return e=c[a],b=function(){return e},d=function(a){return e=a,c.updateProjectionMatrix(),this},Object.defineProperty(c,a,{get:b,set:d},!0)}),c},S3age.Renderer=function(a,b){var c,d;return null==b&&(b={}),b.antialias=b.antialias||!0,c=new THREE.WebGLRenderer(b),["autoClear","autoClearColor","autoClearDepth","autoClearStencil","autoScaleCubemaps","autoUpdateObjects","gammaInput","gammaOutput","maxMorphNormals","maxMorphTargets","physicallyBasedShading","renderPluginsPost","renderPluginsPre","shadowMapAutoUpdate","shadowMapCascade","shadowMapCullFace","shadowMapCullFace","shadowMapDebug","shadowMapEnabled","shadowMapPlugin","shadowMapType","sortObjects"].forEach(function(a){return null!=b[a]?c[a]=b[a]:void 0}),["setClearColor","setDepthTest","setDepthWrite","setBlending","setClearColorHex"].forEach(function(a){var d;return null!=b[a]?(d=b[a],d.length||(d=[d]),c[a].apply(c,d)):void 0}),c.resize=function(){return c.setSize(a.width,a.height)},d=c.render,c.render=function(b,e,f,g){return null==b&&(b=a.scene),null==e&&(e=a.camera),null==f&&(f=void 0),null==g&&(g=void 0),d.apply(c,[b,e,f,g])},c},S3age.Click=function(a,b){var c,d,e,f,g;c=0,e={mousedown:function(){return c=Date.now()},mouseup:function(a){var d,e;return a.preventDefault(),Date.now()-c>S3age.Click.CLICK_TIMEOUT?void 0:(c=0,e=b.raycast(a.clientX,a.clientY),d=e.intersectObjects(b.scene.children,!0),b.clicked(d))}},g=[];for(d in e)f=e[d],g.push(a.addEventListener(d,f,!1));return g},S3age.Click.CLICK_TIMEOUT=100,S3age.Loader=function(a,b){var c=this;return THREE.Object3D.apply(this,[].slice.call(arguments,2)),(new a).load(b,function(a,b){return c.add(new THREE.Mesh(a,new THREE.MeshFaceMaterial(b)))})},S3age.Loader.prototype=Object.create(THREE.Object3D.prototype),S3age.Controls={},S3age.Controls.Sphere=function(a,b){var c,d,e,f,g,h;return d=new THREE.Vector3(0,0,0),c={ZOOM:{FOV:250,TRUCK:7500},SPIN:{UP:2500,LEFT:15e3}},h=new BoundDamper(35,70),f=new BoundDamper(2,7.5),f.position=3,g={up:new SigmoidDamper,left:new Damper},b.renderer.domElement.addEventListener("mousewheel",function(a){return a.altKey===!0?(h.push(a.wheelDeltaX/c.ZOOM.FOV),f.push(-a.wheelDeltaY/c.ZOOM.TRUCK)):(g.up.push(-a.wheelDeltaY/c.SPIN.UP),g.left.push(a.wheelDeltaX/c.SPIN.LEFT))}),e=b.camera,this.target=d,this.update=function(){var a,b,c,d,i,j;for(j=[g.left,g.up,f,h],d=0,i=j.length;i>d;d++)a=j[d],a.step();return e.fov=h.position,b=g.up.position*Math.PI,c=g.left.position*Math.PI,e.position.fromSpherical(c,b,f.position),e.position.add(this.target),e.lookAt(this.target)},this},S3age.Extras={},S3age.Extras.Globe=function(a){return this.radius=null!=a?a:1,THREE.Object3D.apply(this,[].slice.call(arguments,1)),THREE.Object3D.prototype.add.call(this,this.tilted=new THREE.Object3D),this.tilted.rotation=this.rotation.z=Math.toRad(23.4),this.speed={rotation:.001},this.markers=new THREE.Object3D,this.markers.updateable=[],this.add(this.markers),this},S3age.Extras.Globe.prototype=Object.create(THREE.Object3D.prototype),S3age.Extras.Globe.prototype.update=function(a){var b,c,d,e,f;for(this.tilted.rotation.y+=this.speed.rotation,e=this.markers.updateable,f=[],c=0,d=e.length;d>c;c++)b=e[c],f.push("function"==typeof b.update?b.update(a):void 0);return f},S3age.Extras.Globe.prototype.addMarker=function(a,b,c){var d,e;return b=Math.toRad(c||a.lat),c=Math.toRad(c||a.lon),d=new THREE.Object3D,d.rotation.y=c,d.rotation.z=b,this.markers.add(d),e=new THREE.Object3D,e.position.x=1.001*this.radius,e.rotation.y=Math.PI/2,d.add(e),e.add(a),this.markers.updateable.push(a),this},S3age.Extras.Globe.prototype.add=function(a){return this.tilted.add(a)},THREE.Vector3.prototype.fromSpherical=function(a,b,c){var d,e,f,g;return g=Math.sin(a),e=Math.cos(a),f=Math.sin(b),d=Math.cos(b),this.x=c*f*e,this.z=c*f*g,this.y=c*d,this},window.Damper=function(a){return this.friction=null!=a?a:.1,this.position=0,this.velocity=0,this},Damper.prototype.step=function(){return this.position+=this.velocity,this.velocity*=1-this.friction,this},Damper.prototype.push=function(a){return this.velocity+=a,this},window.BoundDamper=function(a,b,c){return this.min=null!=a?a:-1,this.max=null!=b?b:1,this.friction=null!=c?c:.1,Damper.call(this),this.delta=2*(this.max-this.min),this},BoundDamper.prototype=Object.create(Damper.prototype),BoundDamper.prototype.step=function(){return Damper.prototype.step.call(this),this.position=this.position.clamp(this.min,this.max),this},BoundDamper.prototype.push=function(a){return Damper.prototype.push.call(this,a),this.velocity=this.velocity.clamp(-this.friction*this.delta,this.friction*this.delta),this},window.SigmoidDamper=function(a){return this.friction=null!=a?a:.1,this.point=0,BoundDamper.call(this,-6,6),Object.defineProperty(this,"position",{set:function(a){return this.point=a},get:function(){return Math.sigmoid(this.point)}}),this},SigmoidDamper.prototype=Object.create(BoundDamper.prototype),SigmoidDamper.prototype.step=function(){return this.point+=this.velocity,this.point=this.point.clamp(this.min,this.max),this.velocity*=1-this.friction,this.velocity=this.velocity.clamp(-this.friction*this.delta,this.friction*this.delta),this},Number.prototype.clamp=Number.prototype.clamp||function(a,b){return Math.min(b,Math.max(this,a))},Math.sigmoid=Math.sigmoid||function(a){return 1/(1+Math.exp(-a))},Math.lerp=function(a,b,c,d,e){return a===b?d:(a-b)*(e-d)/(c-b)+d},Math.toRad=function(a){return a*Math.PI/180};